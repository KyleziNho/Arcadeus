<!doctype html>
<html>
<head>
    <meta charset="UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge"/>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>M&A PE Modeler</title>
    <script src="https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js"></script>
    <link rel="stylesheet" href="taskpane.css">
    <script defer="defer" src="taskpane.js"></script>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>M&A PE Modeler</h1>
            <p>Professional deal modeling with AI assistance</p>
        </div>

        <div class="section collapsible-section" id="highLevelParametersSection">
            <button class="minimize-btn" id="minimizeHighLevel" aria-label="Minimize High-Level Parameters">
                <span class="minimize-icon">−</span>
            </button>
            <h3 data-emoji="⚙️">High-Level Parameters</h3>
            <div class="section-content" id="highLevelContent">
                <div class="form-group">
                    <label>Currency</label>
                    <select id="currency">
                        <option value="USD">USD - US Dollar</option>
                        <option value="EUR">EUR - Euro</option>
                        <option value="GBP">GBP - British Pound</option>
                        <option value="JPY">JPY - Japanese Yen</option>
                        <option value="CAD">CAD - Canadian Dollar</option>
                        <option value="AUD">AUD - Australian Dollar</option>
                        <option value="CHF">CHF - Swiss Franc</option>
                        <option value="CNY">CNY - Chinese Yuan</option>
                        <option value="SEK">SEK - Swedish Krona</option>
                        <option value="NOK">NOK - Norwegian Krone</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Project Start Date</label>
                    <input type="date" id="projectStartDate" />
                </div>
                
                <div class="form-group">
                    <label>Model Periods</label>
                    <select id="modelPeriods">
                        <option value="daily">Daily</option>
                        <option value="monthly" selected>Monthly</option>
                        <option value="quarterly">Quarterly</option>
                        <option value="yearly">Yearly</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Project End Date</label>
                    <input type="date" id="projectEndDate" />
                </div>
                
                <div class="form-group">
                    <label>Holding Periods (Calculated)</label>
                    <input type="text" id="holdingPeriodsCalculated" readonly placeholder="Select dates and period type to calculate" />
                    <small class="help-text">Automatically calculated based on start/end dates and period type</small>
                </div>
            </div>
        </div>

        <div class="section collapsible-section" id="dealAssumptionsSection">
            <button class="minimize-btn" id="minimizeAssumptions" aria-label="Minimize Deal Assumptions">
                <span class="minimize-icon">−</span>
            </button>
            <h3 data-emoji="📊">Deal Assumptions</h3>
            <div class="section-content" id="assumptionsContent">
            <div class="form-group">
                <label>Deal Name</label>
                <input type="text" id="dealName" placeholder="e.g., TechCo Acquisition"/>
                <small class="help-text">Name or identifier for this transaction</small>
            </div>
            <div class="form-group">
                <label>Deal Value</label>
                <input type="number" id="dealValue" placeholder="e.g., 100000000" step="1000000"/>
                <small class="help-text">Enter the total transaction value in your selected currency</small>
            </div>
            <div class="form-group">
                <label>Transaction Fee (%)</label>
                <input type="number" id="transactionFee" placeholder="e.g., 2.5" step="0.1" value="2.5"/>
                <small class="help-text">Investment banking and advisory fees as percentage of deal value</small>
            </div>
            <div class="form-group">
                <label>Deal LTV (%)</label>
                <input type="number" id="dealLTV" placeholder="e.g., 70" step="1" value="70"/>
                <small class="help-text">Loan-to-Value ratio for debt financing</small>
            </div>
            <div class="form-group">
                <label>Equity Contribution (Calculated)</label>
                <input type="text" id="equityContribution" readonly placeholder="Will calculate based on Deal Value and LTV"/>
                <small class="help-text">Automatically calculated: Deal Value × (100% - LTV%)</small>
            </div>
            <div class="form-group">
                <label>Debt Financing (Calculated)</label>
                <input type="text" id="debtFinancing" readonly placeholder="Will calculate based on Deal Value and LTV"/>
                <small class="help-text">Automatically calculated: Deal Value × LTV%</small>
            </div>
            </div>
        </div>

        <div class="section collapsible-section" id="revenueItemsSection">
            <button class="minimize-btn" id="minimizeRevenue" aria-label="Minimize Revenue Items">
                <span class="minimize-icon">−</span>
            </button>
            <h3 data-emoji="📈">Revenue Items</h3>
            <div class="section-content" id="revenueContent">
                <div class="revenue-items-container" id="revenueItemsContainer">
                    <!-- Revenue items will be dynamically added here -->
                </div>
                <div class="revenue-actions">
                    <button class="button button-secondary" id="addRevenueItem">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"></circle>
                            <line x1="12" y1="8" x2="12" y2="16"></line>
                            <line x1="8" y1="12" x2="16" y2="12"></line>
                        </svg>
                        Add Revenue Item
                    </button>
                </div>
            </div>
        </div>

        <div class="section collapsible-section" id="costItemsSection">
            <button class="minimize-btn" id="minimizeCost" aria-label="Minimize Cost Items">
                <span class="minimize-icon">−</span>
            </button>
            <h3 data-emoji="💸">Cost Items</h3>
            <div class="section-content" id="costContent">
                <div class="cost-items-container" id="costItemsContainer">
                    <!-- Cost items will be dynamically added here -->
                </div>
                <div class="cost-actions">
                    <button class="button button-secondary" id="addCostItem">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"></circle>
                            <line x1="12" y1="8" x2="12" y2="16"></line>
                            <line x1="8" y1="12" x2="16" y2="12"></line>
                        </svg>
                        Add Cost Item
                    </button>
                </div>
            </div>
        </div>

        <div class="section collapsible-section" id="debtModelSection">
            <button class="minimize-btn" id="minimizeDebtModel" aria-label="Minimize Debt Model">
                <span class="minimize-icon">−</span>
            </button>
            <h3 data-emoji="💰">Debt Model</h3>
            <div class="section-content" id="debtModelContent">
                
                <!-- Debt Configuration -->
                <div class="debt-config-group">
                    <div class="form-group">
                        <label>Debt Financing Status</label>
                        <div class="debt-status" id="debtStatus">
                            <div class="status-message" id="debtStatusMessage">
                                Please input a higher LTV to access debt financing options
                            </div>
                        </div>
                    </div>

                    <div class="debt-settings" id="debtSettings" style="display: none;">
                        <div class="form-group">
                            <label>Loan Issuance Fees (%)</label>
                            <input type="number" id="loanIssuanceFees" placeholder="e.g., 1.5" step="0.1" value="1.5">
                            <small class="help-text">Fees for arranging and issuing the debt financing</small>
                        </div>
                        <div class="form-group">
                            <label>Interest Rate Type</label>
                            <div class="radio-group">
                                <label class="radio-option">
                                    <input type="radio" name="rateType" value="fixed" id="rateTypeFixed" checked>
                                    <span class="radio-custom"></span>
                                    Fixed Rate
                                </label>
                                <label class="radio-option">
                                    <input type="radio" name="rateType" value="floating" id="rateTypeFloating">
                                    <span class="radio-custom"></span>
                                    Floating Rate (Base + Margin)
                                </label>
                            </div>
                        </div>

                        <div class="rate-inputs">
                            <div class="form-group" id="fixedRateGroup">
                                <label>Fixed Interest Rate (%)</label>
                                <input type="number" id="fixedRate" placeholder="e.g., 5.5" step="0.1" value="5.5">
                            </div>

                            <div class="form-group" id="baseRateGroup" style="display: none;">
                                <label>Base Interest Rate - US Fed (%)</label>
                                <input type="number" id="baseRate" placeholder="e.g., 3.9" step="0.1" value="3.9">
                            </div>

                            <div class="form-group" id="marginGroup" style="display: none;">
                                <label>Credit Margin (%)</label>
                                <input type="number" id="creditMargin" placeholder="e.g., 2.0" step="0.1" value="2.0">
                                <small class="rate-note">Industry standard is typically 2% - 3% for most deals</small>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Debt Issuance Points (When to take debt)</label>
                            <div class="debt-timing-options">
                                <label class="checkbox-option">
                                    <input type="checkbox" id="debtAtAcquisition" checked>
                                    <span class="checkbox-custom"></span>
                                    At Acquisition
                                </label>
                                <label class="checkbox-option">
                                    <input type="checkbox" id="debtForCapex">
                                    <span class="checkbox-custom"></span>
                                    For CapEx Requirements
                                </label>
                                <label class="checkbox-option">
                                    <input type="checkbox" id="debtForWorking">
                                    <span class="checkbox-custom"></span>
                                    For Working Capital
                                </label>
                                <label class="checkbox-option">
                                    <input type="checkbox" id="debtForDividends">
                                    <span class="checkbox-custom"></span>
                                    For Dividend Payments
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Debt Schedule Preview -->
                <div class="debt-schedule" id="debtSchedule" style="display: none;">
                    <h4>Debt Schedule Preview</h4>
                    <div class="schedule-table-container">
                        <table class="debt-table" id="debtPreviewTable">
                            <!-- Dynamic transposed table will be inserted here -->
                        </table>
                    </div>
                    <button class="button button-secondary" id="generateDebtSchedule">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                            <circle cx="9" cy="9" r="2"></circle>
                            <path d="M21 15l-3.086-3.086a2 2 0 0 0-2.828 0L6 21"></path>
                        </svg>
                        Generate Debt Schedule in Excel
                    </button>
                </div>

            </div>
        </div>

        <div class="section chat-section">
            <h3 data-emoji="🤖">AI Assistant</h3>
            <div class="file-upload-section">
                <div class="file-dropzone" id="fileDropzone">
                    <div class="dropzone-content">
                        <svg class="upload-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                            <polyline points="7,10 12,15 17,10"></polyline>
                            <line x1="12" y1="15" x2="12" y2="3"></line>
                        </svg>
                        <p>Drop PDF or CSV files here, or <span class="upload-link">browse files</span></p>
                        <small>Maximum 4 files, up to 10MB each</small>
                    </div>
                    <input type="file" id="fileInput" multiple="multiple" accept=".pdf,.csv" style="display: none;">
                </div>
                <div class="uploaded-files" id="uploadedFiles" style="display: none;">
                    <h4>Uploaded Files:</h4>
                    <div class="file-list" id="fileList"></div>
                </div>
            </div>
            <div class="chat-container">
                <div class="chat-messages" id="chatMessages">
                    <div class="message-bubble assistant-bubble">
                        <div class="message-content">
                            <div class="message-text">Hi! Upload your M&A documents (PDF/CSV) and I'll help analyze them to fill out your assumptions template. You can also ask me questions about Excel formulas and calculations!</div>
                        </div>
                    </div>
                </div>
                <div class="chat-input-container">
                    <div class="chat-input-wrapper">
                        <input id="chatInput" placeholder="Ask me to analyze your documents or help with Excel..."/>
                        <button class="send-button" id="sendChatBtn">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <line x1="22" y1="2" x2="11" y2="13"></line>
                                <polygon points="22,2 15,22 11,13 2,9 22,2"></polygon>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>